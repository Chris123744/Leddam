Args in experiment:
Namespace(batch_size=128, c_out=7, checkpoints='./checkpoints', d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', dropout=0.0, enc_in=7, features='M', freq='h', gpu=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='constant', model='Leddam', model_id='ETTh1_96_336', n_layers=1, num_workers=0, patience=6, pe_type='sincos', pred_len=336, revin=True, root_path='dataset/ETT-small/', seq_len=96, target='OT', task_name='long_term_forecast', train_epochs=100, use_amp=True, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_pl336_n_layers_1_d_model_512_dropout_0.0_pe_type_sincos_bs_128_lr_0.0001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
Epoch: 1 cost time: 6.282636880874634
Epoch: 1, Steps: 64 | Train Loss: 0.511  vali_loss: 1.290   test_loss: 0.477 
Validation loss decreased (inf --> 1.289858).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 3.8550350666046143
Epoch: 2, Steps: 64 | Train Loss: 0.478  vali_loss: 1.286   test_loss: 0.466 
Validation loss decreased (1.289858 --> 1.285778).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 3.8519492149353027
Epoch: 3, Steps: 64 | Train Loss: 0.464  vali_loss: 1.283   test_loss: 0.459 
Validation loss decreased (1.285778 --> 1.282697).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 3.65252947807312
Epoch: 4, Steps: 64 | Train Loss: 0.454  vali_loss: 1.307   test_loss: 0.461 
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0001
Epoch: 5 cost time: 3.7404887676239014
Epoch: 5, Steps: 64 | Train Loss: 0.445  vali_loss: 1.331   test_loss: 0.462 
EarlyStopping counter: 2 out of 6
Updating learning rate to 0.0001
Epoch: 6 cost time: 3.834660530090332
Epoch: 6, Steps: 64 | Train Loss: 0.437  vali_loss: 1.325   test_loss: 0.481 
EarlyStopping counter: 3 out of 6
Updating learning rate to 0.0001
Epoch: 7 cost time: 3.914937973022461
Epoch: 7, Steps: 64 | Train Loss: 0.432  vali_loss: 1.337   test_loss: 0.475 
EarlyStopping counter: 4 out of 6
Updating learning rate to 0.0001
Epoch: 8 cost time: 3.621232509613037
Epoch: 8, Steps: 64 | Train Loss: 0.426  vali_loss: 1.348   test_loss: 0.486 
EarlyStopping counter: 5 out of 6
Updating learning rate to 0.0001
Epoch: 9 cost time: 3.574314594268799
Epoch: 9, Steps: 64 | Train Loss: 0.421  vali_loss: 1.340   test_loss: 0.482 
EarlyStopping counter: 6 out of 6
Early stopping
>>>>>>>testing : ETTh1_pl336_n_layers_1_d_model_512_dropout_0.0_pe_type_sincos_bs_128_lr_0.0001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
loading model
Model weights deleted.
test shape: (2545, 336, 7) (2545, 336, 7)
mse:  0.459  mae:  0.442
