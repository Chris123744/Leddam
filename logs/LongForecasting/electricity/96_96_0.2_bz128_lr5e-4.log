Args in experiment:
Namespace(batch_size=128, c_out=321, checkpoints='./checkpoints', d_model=256, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', dropout=0.2, enc_in=321, features='M', freq='h', gpu=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0005, loss='mse', lradj='constant', model='Leddam', model_id='electricity_96_96', n_layers=3, num_workers=0, patience=6, pe_type='no', pred_len=96, revin=True, root_path='dataset/electricity/', seq_len=96, target='OT', task_name='long_term_forecast', train_epochs=100, use_amp=True, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_pl96_n_layers_3_d_model_256_dropout_0.2_pe_type_no_bs_128_lr_0.0005>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
Epoch: 1 cost time: 59.03288459777832
Epoch: 1, Steps: 142 | Train Loss: 0.226  vali_loss: 0.162   test_loss: 0.182 
Validation loss decreased (inf --> 0.161908).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 53.3719117641449
Epoch: 2, Steps: 142 | Train Loss: 0.173  vali_loss: 0.145   test_loss: 0.163 
Validation loss decreased (0.161908 --> 0.145165).  Saving model ...
Updating learning rate to 0.0005
Epoch: 3 cost time: 54.71393823623657
Epoch: 3, Steps: 142 | Train Loss: 0.159  vali_loss: 0.138   test_loss: 0.157 
Validation loss decreased (0.145165 --> 0.138127).  Saving model ...
Updating learning rate to 0.0005
Epoch: 4 cost time: 55.06911873817444
Epoch: 4, Steps: 142 | Train Loss: 0.153  vali_loss: 0.133   test_loss: 0.153 
Validation loss decreased (0.138127 --> 0.132609).  Saving model ...
Updating learning rate to 0.0005
Epoch: 5 cost time: 55.50296640396118
Epoch: 5, Steps: 142 | Train Loss: 0.148  vali_loss: 0.130   test_loss: 0.149 
Validation loss decreased (0.132609 --> 0.130065).  Saving model ...
Updating learning rate to 0.0005
Epoch: 6 cost time: 55.13140344619751
Epoch: 6, Steps: 142 | Train Loss: 0.145  vali_loss: 0.128   test_loss: 0.148 
Validation loss decreased (0.130065 --> 0.128016).  Saving model ...
Updating learning rate to 0.0005
Epoch: 7 cost time: 54.38598012924194
Epoch: 7, Steps: 142 | Train Loss: 0.143  vali_loss: 0.127   test_loss: 0.146 
Validation loss decreased (0.128016 --> 0.126704).  Saving model ...
Updating learning rate to 0.0005
Epoch: 8 cost time: 54.57420992851257
Epoch: 8, Steps: 142 | Train Loss: 0.141  vali_loss: 0.126   test_loss: 0.145 
Validation loss decreased (0.126704 --> 0.125750).  Saving model ...
Updating learning rate to 0.0005
Epoch: 9 cost time: 54.03656578063965
Epoch: 9, Steps: 142 | Train Loss: 0.139  vali_loss: 0.125   test_loss: 0.145 
Validation loss decreased (0.125750 --> 0.125138).  Saving model ...
Updating learning rate to 0.0005
Epoch: 10 cost time: 56.060086727142334
Epoch: 10, Steps: 142 | Train Loss: 0.138  vali_loss: 0.125   test_loss: 0.145 
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0005
Epoch: 11 cost time: 57.450660943984985
Epoch: 11, Steps: 142 | Train Loss: 0.137  vali_loss: 0.124   test_loss: 0.144 
Validation loss decreased (0.125138 --> 0.124309).  Saving model ...
Updating learning rate to 0.0005
Epoch: 12 cost time: 55.15785336494446
Epoch: 12, Steps: 142 | Train Loss: 0.135  vali_loss: 0.122   test_loss: 0.142 
Validation loss decreased (0.124309 --> 0.121858).  Saving model ...
Updating learning rate to 0.0005
Epoch: 13 cost time: 56.04216909408569
Epoch: 13, Steps: 142 | Train Loss: 0.134  vali_loss: 0.122   test_loss: 0.143 
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0005
Epoch: 14 cost time: 55.44887924194336
Epoch: 14, Steps: 142 | Train Loss: 0.133  vali_loss: 0.123   test_loss: 0.142 
EarlyStopping counter: 2 out of 6
Updating learning rate to 0.0005
Epoch: 15 cost time: 55.45141673088074
Epoch: 15, Steps: 142 | Train Loss: 0.131  vali_loss: 0.121   test_loss: 0.142 
Validation loss decreased (0.121858 --> 0.120672).  Saving model ...
Updating learning rate to 0.0005
Epoch: 16 cost time: 54.65530800819397
Epoch: 16, Steps: 142 | Train Loss: 0.130  vali_loss: 0.122   test_loss: 0.142 
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0005
Epoch: 17 cost time: 56.62330198287964
Epoch: 17, Steps: 142 | Train Loss: 0.129  vali_loss: 0.121   test_loss: 0.142 
EarlyStopping counter: 2 out of 6
Updating learning rate to 0.0005
Epoch: 18 cost time: 54.971325159072876
Epoch: 18, Steps: 142 | Train Loss: 0.127  vali_loss: 0.120   test_loss: 0.141 
Validation loss decreased (0.120672 --> 0.119749).  Saving model ...
Updating learning rate to 0.0005
Epoch: 19 cost time: 57.37720489501953
Epoch: 19, Steps: 142 | Train Loss: 0.127  vali_loss: 0.120   test_loss: 0.141 
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0005
Epoch: 20 cost time: 55.74966740608215
Epoch: 20, Steps: 142 | Train Loss: 0.125  vali_loss: 0.121   test_loss: 0.142 
EarlyStopping counter: 2 out of 6
Updating learning rate to 0.0005
Epoch: 21 cost time: 54.85933494567871
Epoch: 21, Steps: 142 | Train Loss: 0.124  vali_loss: 0.119   test_loss: 0.141 
Validation loss decreased (0.119749 --> 0.118699).  Saving model ...
Updating learning rate to 0.0005
Epoch: 22 cost time: 55.35500741004944
Epoch: 22, Steps: 142 | Train Loss: 0.123  vali_loss: 0.119   test_loss: 0.141 
EarlyStopping counter: 1 out of 6
Updating learning rate to 0.0005
Epoch: 23 cost time: 56.11613440513611
Epoch: 23, Steps: 142 | Train Loss: 0.123  vali_loss: 0.119   test_loss: 0.141 
EarlyStopping counter: 2 out of 6
Updating learning rate to 0.0005
Epoch: 24 cost time: 56.39014196395874
Epoch: 24, Steps: 142 | Train Loss: 0.121  vali_loss: 0.122   test_loss: 0.144 
EarlyStopping counter: 3 out of 6
Updating learning rate to 0.0005
Epoch: 25 cost time: 55.534645557403564
Epoch: 25, Steps: 142 | Train Loss: 0.122  vali_loss: 0.119   test_loss: 0.141 
EarlyStopping counter: 4 out of 6
Updating learning rate to 0.0005
Epoch: 26 cost time: 55.064597606658936
Epoch: 26, Steps: 142 | Train Loss: 0.121  vali_loss: 0.119   test_loss: 0.142 
EarlyStopping counter: 5 out of 6
Updating learning rate to 0.0005
Epoch: 27 cost time: 55.125744581222534
Epoch: 27, Steps: 142 | Train Loss: 0.119  vali_loss: 0.121   test_loss: 0.143 
EarlyStopping counter: 6 out of 6
Early stopping
>>>>>>>testing : electricity_pl96_n_layers_3_d_model_256_dropout_0.2_pe_type_no_bs_128_lr_0.0005<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
loading model
Model weights deleted.
test shape: (5165, 96, 321) (5165, 96, 321)
mse:  0.141  mae:  0.235
